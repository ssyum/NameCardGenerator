<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namecard Generator</title>
    <link rel="stylesheet" href="style.css">
    <script>
        // Set up PDF.js worker before loading
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script src="app.js"></script>

</head>

<body>
    <div class="container">
        <header>
            <h1>Namecard Generator</h1>
            <p class="subtitle">Create professional namecards for your event</p>
        </header>

        <!-- Step 1: Name Input -->
        <section id="step1" class="step active">
            <div class="card">
                <h2>Step 1: Input Names</h2>
                <p class="instruction">Upload a CSV file or paste names directly</p>

                <div class="input-group">
                    <label class="form-label">Upload CSV File</label>
                    <div class="file-upload-wrapper">
                        <input type="file" id="csvFile" accept=".csv" class="file-input">
                        <label for="csvFile" class="btn btn--secondary">Choose CSV File</label>
                        <span id="csvFileName" class="file-name">No file chosen</span>
                    </div>
                    <small class="help-text">CSV format: FirstName,LastName (with header row)</small>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="input-group">
                    <label class="form-label" for="textInput">Paste Names (one per line)</label>
                    <textarea id="textInput" class="form-control" rows="8"
                        placeholder="John Doe&#10;Jane Smith&#10;Michael Johnson&#10;Sarah Williams"></textarea>
                    <small class="help-text">Format: FirstName LastName (one per line)</small>
                </div>

                <div id="nameCount" class="status status--info" style="display: none;">
                    <span id="nameCountText">0 names loaded</span>
                </div>

                <button id="loadNamesBtn" class="btn btn--primary">Load Names</button>
            </div>
        </section>

        <!-- Step 2: PDF Template Upload -->
        <section id="step2" class="step">
            <div class="card">
                <h2>Step 2: Upload PDF Template</h2>
                <p class="instruction">Upload your A4 template (will be divided into 4 quadrants)</p>

                <div class="input-group">
                    <div class="file-upload-wrapper">
                        <input type="file" id="pdfFile" accept=".pdf" class="file-input">
                        <label for="pdfFile" class="btn btn--secondary">Choose PDF Template</label>
                        <span id="pdfFileName" class="file-name">No file chosen</span>
                    </div>
                </div>

                <button id="loadPdfBtn" class="btn btn--primary">Load Template</button>
            </div>
        </section>

        <!-- Step 3: Optional Font Upload -->
        <section id="step3" class="step">
            <div class="card">
                <h2>Step 3: Custom Font (Optional)</h2>
                <p class="instruction">Upload a .ttf font file or skip to use default font</p>

                <div class="input-group">
                    <div class="file-upload-wrapper">
                        <input type="file" id="fontFile" accept=".ttf" class="file-input">
                        <label for="fontFile" class="btn btn--secondary">Choose Font File</label>
                        <span id="fontFileName" class="file-name">No file chosen</span>
                    </div>
                </div>

                <div class="button-group">
                    <button id="loadFontBtn" class="btn btn--secondary">Upload Font</button>
                    <button id="skipFontBtn" class="btn btn--primary">Skip (Use Default)</button>
                </div>
            </div>
        </section>

        <!-- Step 4: Interactive Editor -->
        <section id="step4" class="step">
            <div class="editor-container">
                <div class="editor-header">
                    <h2>Step 4: Position &amp; Edit Names</h2>
                    <div class="pagination">
                        <button id="prevPageBtn" class="btn btn--outline btn--sm">← Previous</button>
                        <span id="pageInfo" class="page-info">Page 1 of 1</span>
                        <button id="nextPageBtn" class="btn btn--outline btn--sm">Next →</button>
                    </div>
                </div>

                <div class="editor-layout">
                    <div class="canvas-container">
                        <canvas id="editorCanvas"></canvas>
                        <div id="quadrantGuides" class="quadrant-guides">
                            <div class="guide guide-vertical" style="left: 50%;"></div>
                            <div class="guide guide-horizontal" style="top: 50%;"></div>
                        </div>
                    </div>

                    <div class="controls-panel">
                        <h3>Text Controls</h3>
                        <p class="help-text">Click a name to select, drag to move, double-click to edit</p>

                        <div id="textControls" class="text-controls">
                            <div class="control-group">
                                <label class="form-label">Selected Name:</label>
                                <input type="text" id="textContentInput" class="form-control"
                                    placeholder="Select a name first">
                            </div>

                            <div class="control-group">
                                <label class="form-label" for="fontSizeSlider">Font Size: <span
                                        id="fontSizeValue">24</span>px</label>
                                <input type="range" id="fontSizeSlider" min="10" max="72" value="24" class="slider">
                            </div>

                            <div class="control-group">
                                <label class="form-label" for="letterSpacingSlider">Letter Spacing: <span
                                        id="letterSpacingValue">0</span>px</label>
                                <input type="range" id="letterSpacingSlider" min="-5" max="20" value="0" class="slider">
                            </div>

                            <div class="control-group">
                                <button id="centerTextBtn" class="btn btn--secondary btn--full-width">Center in
                                    Quadrant</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="editor-footer">
                    <button id="generatePdfBtn" class="btn btn--primary btn-lg">Generate &amp; Download PDF</button>
                </div>
            </div>
        </section>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="spinner"></div>
            <p id="loadingText">Processing...</p>
        </div>

        <!-- Error Messages -->
        <div id="errorContainer" class="error-container"></div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://unpkg.com/pdf-lib"></script>

    <!-- Application Script -->
    <script src="app.js"></script>
</body>

</html>